# 開発者向けの情報

この記事は、開発を行う人に知っておいて頂きたい情報（開発環境構築手順、開発ルールなど）をまとめています。

## 目次

1. 開発環境の構築
2. ブランチ運用ルール
3. 多言語対応
4. フィーチャーフラグ

## 1.開発環境の構築

環境構築・ビルド方法は、以下を参照してください

- [ビルド・実行方法](how_to_build.md)

## 2.ブランチ運用ルール

### 開発時のブランチ運用

機能追加や不具合修正などの修正を行う場合は、必ず「Pull Request作成」を行なってください。
また、Pull Requestのマージ先は、基本的には`development`ブランチにのみ行なってください。
基本はdevelopmentブランチを育てていって、キリがいいタイミング(例えばどれかのコンテンツが完成した等)でmasterに反映するという想定です。

### ブランチの命名ルール

具体指定なし

### ブランチの役割

現在、運用しているブランチの役割は以下の通りです。
※PR作成権限が記載されていますが、実際には誰でも出来てしまうので権限というよりそういう運用のイメージで。という感じです。

| ブランチ名  | 役割                                     | PR作成権限 | 補足                                                                                                                                 |
| ----------- | ---------------------------------------- | ---------- | ------------------------------------------------------------------------------------------------------------------------------------ |
| experiment  | (実験的な開発も含む)開発段階の修正を集約 | 全開発者   | 実験的な実装など、本番環境に最終的にマージする予定がないが、デプロイしてオンラインで挙動を確認したい場合にここのブランチを使用する。 |
| development | 開発段階の修正を集約                     | 全開発者   | 基本的には、修正は本ブランチに対して、Pull Requestを作成してください                                                                 |
| staging     | 本番リリース前の最終動作確認             | 全開発者   | -                                                                                                                                    |
| master      | 本番環境                                 | 全開発者   | Stagingで動作に問題がないことを確認してから、developmentからPull Requestを作成してマージ                                             |

### ステージング・本番環境への反映

以下のブランチが更新されると、ステージングや本番サイトが更新されます。

| ブランチ名  | 更新されるWebサイト      |
| ----------- | ------------------------ |
| experiment  | xxxxxxxxxxxxxxxxxxxxxxxx |
| development | xxxxxxxxxxxxxxxxxx       |
| staging     | xxxxxxxxxxxxxxxxxx       |
| master      | xxxxxxxxxxxxxxxx         |

## 3.多言語対応

このWebサイトは基本的に「日本語」「英語」の2種類の言語に対応する必要があります。

### 多言語対応

Next Jsの多言語対応機能使用予定

# 静的ファイルの取り扱い

PDFなどの静的ファイルを扱いたい場合は、public/assetsフォルダーに配置

## ファイルの参照先URLのルール

ファイルの参照先URLのルールについて、以下の対応例をご覧ください。階層構造がある場合も、URLとして認識されます。

| ファイル配置場所    | 参照URL                              |
| ------------------- | ------------------------------------ |
| static/hoge.txt     | `http://localhost:3000/hoge.txt`     |
| static/sub/hoge.txt | `http://localhost:3000/sub/hoge.txt` |

## 4.フィーチャーフラグ

環境変数の値を使用したフラグを組み込んで、環境ごとに機能を出し分けするために使用するのがフィーチャーフラグです。

本番環境と開発環境で差異は大きくしたくない(ユーザー目線から見て一連の機能として成立していない段階でも、完成した部分はどんどんマージしたい)が、未完成部分はユーザーには見せたくないというニーズを満たすため等の理由で使用されます。

フィーチャーフラグ自体は概念に近いもので、実装はいろいろできますが、あまり複雑化させると運用が逆にむつかしくなるので、外部公開サイトでは本番環境かどうかを識別するフラグを導入し、本番環境では出したくない機能はこのフラグで表示を切り替えることで制御する。という使い方を基本としようと思います。

具体的な使い方はdeveloppersinfoページなどを参照してください
